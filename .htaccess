RewriteEngine On
RewriteBase /bizendao/

# Root → language redirect (Accept-Language)
RewriteCond %{HTTP:Accept-Language} ^ja [NC]
RewriteRule ^$ ja/index.html [L,R=302]
RewriteRule ^$ en/index.html [L,R=302]

# /bizendao/regist/:discordId/:secret → dapp/regist/?discord=:discordId&secret=:secret
RewriteRule ^regist/([0-9]+)/(.+)$ dapp/regist/?discord=$1&secret=$2 [L,R=302]

# /bizendao/regist/:discordId → dapp/regist/?discord=:discordId
RewriteRule ^regist/([0-9]+)/?$ dapp/regist/?discord=$1 [L,R=302]

# /bizendao/account/:address → dapp/account.html?address=:address
RewriteRule ^account/(0x[0-9a-fA-F]{40})/?$ dapp/account.html?address=$1 [L,R=302]

# /bizendao/setting/:page → dapp/setting/:page.html
RewriteRule ^setting/(admin|creator|contract)/?$ dapp/setting/$1.html [L,R=302]

# Legacy URLs → dapp/ (旧パスからの移行リダイレクト)
RewriteRule ^token\.html$ dapp/token.html [QSA,L,R=302]
RewriteRule ^account\.html$ dapp/account.html [QSA,L,R=302]
RewriteRule ^donation\.html$ dapp/donation.html [QSA,L,R=302]
